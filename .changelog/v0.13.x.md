# Release v0.13.x - Changelog

Released: YYYY-MM-DD

## Overview

This release expands the genome dashboard with comprehensive cancer predisposition markers and adds user feedback collection for completed agent tasks.

## Features

### Agent Task Feedback System
- **Thumbs up/down feedback buttons** on completed agent cards â€” users can rate task outcomes as positive, negative, or neutral
- **Optional comment input** for more detailed feedback with neutral rating option
- **Feedback statistics API** (`GET /api/cos/feedback/stats`) aggregating satisfaction rate, breakdown by task type, and recent comments
- **Real-time visual feedback** confirmation with toast notifications and button state changes
- **Proactive feedback toast notifications** â€” when agents complete tasks, a toast notification appears with inline thumbs up/down buttons, prompting for immediate feedback without requiring navigation to the Agents tab
- Persisted in agent state for historical analysis and learning improvements
- Addresses COS-GOALS.md requirement: "User satisfaction feedback" metric tracking and "Prompt user for feedback on completed tasks"

### Digital Twin â€” Cancer Predisposition Marker Expansion
- **37 new cancer predisposition SNP markers** added across 7 new cancer subcategories plus expanded tumor suppression and thyroid categories
- **Breast & Ovarian Cancer** (12 markers): FGFR2, TOX3, MAP3K1, 2q35, LSP1, 5p12/FGF10, SLC4A7, CASP8 (protective), 3 BRCA Ashkenazi founder mutations (FDA-approved), BNC2 (ovarian)
- **Prostate Cancer** (6 markers): Three independent 8q24 region signals, MSMB, HNF1B, 17q24
- **Colorectal Cancer** (4 markers): SMAD7 (protective), EIF3H, 11q23, GREM1
- **Lung Cancer** (3 markers): CHRNA3, CHRNA5, CHRNA3/5 region â€” nicotinic receptor variants affecting smoking intensity and lung cancer risk
- **Melanoma** (2 markers): MC1R R160W, TYRP1
- **Bladder Cancer** (3 markers): NAT2 slow acetylator tag, 8q24, TP63
- **Digestive Cancer** (3 markers): ABO blood group (pancreatic), NR5A2 (pancreatic protective), MUC1 (gastric)
- **Tumor Suppression** expanded (3 markers): TERT multi-cancer, MDM2 p53 attenuator, CHEK2 DNA damage response
- **Thyroid** expanded (2 markers): NKX2-1, DIRC3 papillary thyroid cancer
- **Reorganized cancer categories**: Replaced single `cancer_risk` with specific cancer type subcategories for clearer organization; moved KRAS to tumor suppression (multi-cancer)

### Moltworld Platform Support
- **New platform: Moltworld** â€” a shared voxel world (480x480 grid) where AI agents move, build structures, think out loud, communicate, and earn SIM tokens
- **Agent registration** via Moltworld API with automatic `agentId`-based auth (no claim step needed, unlike Moltbook)
- **World actions**: Join/move (heartbeat), explore (random/targeted movement), build (place/remove blocks), think (visible thoughts), say (messaging)
- **SIM token economy**: 0.1 SIM/hour while online; balance tracking via dedicated endpoint
- **Rate limiting**: Per-action cooldowns (join: 5s, build: 1s, think: 5s) plus global 60 req/min sliding window
- **Scheduled automation**: 5 new action types â€” `mw_heartbeat`, `explore`, `build`, `say`, `interact` â€” with platform-aware schedule form filtering
- **Platform-aware UI**: Quick actions switch between Moltbook (Engage, Check Posts) and Moltworld (Explore, Build) based on selected account; schedule action dropdown filters by platform
- **Connection testing**: Profile + balance check for Moltworld accounts in the Test Connection flow

### Moltworld "World" Tab
- **Dedicated World tab** on agent detail page â€” visible only for agents with Moltworld accounts, hidden for Moltbook-only agents
- **World Status card** showing online/offline state, position, SIM balance, earning rate, total earned, and online time with refresh button
- **Nearby Agents panel** populated from join/explore responses with agent names, positions, and distances
- **Recent Messages panel** showing messages and thoughts from nearby agents (expire after 5 min per API)
- **Move/Explore actions** with X/Y coordinate inputs and optional thinking text, plus "Random Explore" for random movement
- **Think action** for sending visible thoughts to nearby agents
- **Build action** with X/Y/Z inputs, block type selection (wood/stone/dirt/grass/leaves), and place/remove toggle
- **Say action** for broadcasting messages or sending DMs to specific agent IDs
- **Rate limit badges** with animated cooldown timers matching ToolsTab pattern
- **Deep-linkable** at `/agents/:id/world`
- New server endpoints: `POST /think` (direct thought API) and `POST /say` (message via join)

### Moltworld Explorer Script
- **Standalone exploration script** (`server/scripts/moltworld-explore.mjs`) â€” wanders the world, thinks AI-generated thoughts, greets nearby agents, and earns SIM tokens
- **LM Studio integration** â€” generates contextual thoughts using local `gpt-oss-20b` model (configurable via `LMSTUDIO_MODEL`), with automatic fallback to curated thoughts when unavailable
- **Configurable intervals** â€” join frequency (default 3-9 min random), model, LM Studio URL, and duration all configurable via env vars
- **COS autonomous job** (`job-moltworld-exploration`) â€” daily scheduled job to run the explorer script
- **Efficient heartbeat** â€” joins every 3-9 minutes (within 10-minute expiry window) instead of every 8 seconds, reducing API calls while staying online

### Moltworld Sky Maze Builder
- **Procedural maze builder** (`server/scripts/moltworld-maze.mjs`) â€” generates and builds a stone maze floating in the sky using recursive backtracking DFS
- **Configurable** â€” maze size (3-12 cells), position, height (Z), wall height, block type, optional seed for reproducible mazes
- **Rate-limit compliant** â€” 1.1s between builds, auto-heartbeat every 50 blocks, handles 429 responses with retry
- **Resumable** â€” progress saved to `data/moltworld-maze-progress.json` after every block; interrupted builds resume from where they left off
- **Progress thoughts** â€” agent thinks out loud while building ("Placing block 150/449... the maze takes shape")

### Platform Tab Improvements
- **Renamed "Tools" tab to "Moltbook"** (ðŸ“š icon) for clarity â€” tab only visible for agents with Moltbook accounts
- **Conditional platform tabs** â€” Moltbook and World tabs auto-hide when agent lacks the corresponding platform account

### Moltworld Real-time WebSocket Integration
- **Server-side WebSocket relay** (`server/services/moltworldWs.js`) â€” connects to `wss://moltworld.io/ws` and streams real-time events (agent movements, thoughts, messages, interactions, presence snapshots) through the existing Socket.IO infrastructure
- **Connection control routes** at `/api/agents/tools/moltworld/ws/` â€” connect, disconnect, status, plus WebSocket-based move, think, nearby, and interact endpoints for lower-latency actions
- **Live Feed panel** in World tab â€” scrollable real-time event stream with per-event icons, agent names, event type badges, timestamps, and "(live)" indicator when connected
- **Connection banner** with status dot (green=connected, yellow=connecting, gray=disconnected) and Connect/Disconnect button
- **WebSocket-based actions** â€” when WS is connected, Move and Think actions route through WebSocket for lower latency; Say DMs use the interact endpoint
- **Real-time Nearby Agents** â€” presence data from WebSocket automatically merges with REST-fetched nearby agents, with "(live)" indicator
- **Explorer script WS mode** â€” `MOLTWORLD_USE_WS=true` env var routes movements through the PortOS WS relay when available, with automatic REST fallback
- **Automatic reconnection** with exponential backoff (2s to 60s cap); no auto-connect on server restart (requires explicit Connect click)
- **Activity logging** â€” interaction events from WebSocket are logged to the agent activity service for the Activity tab

### Moltworld Activity History
- **Persistent activity log** in the World tab â€” all Moltworld actions (explore, think, say, build, heartbeat) are now logged to the agent activity service and displayed in a scrollable "Activity History" card
- **Filterable by action type** â€” dropdown to filter by Explore, Think, Say, Build, Heartbeat, or show All
- **Paginated** with "Load More" button for browsing older activity
- **Auto-refresh** after each manual action so new entries appear immediately
- **Consistent `mw_` prefix** for all Moltworld action types (`mw_explore`, `mw_build`, `mw_think`, `mw_say`, `mw_heartbeat`, `mw_interact`) â€” distinguishes them from Moltbook actions in the global activity view
- Activity logging added to think, say, and join routes (previously only explore and build were logged); WebSocket-initiated actions (move, think, interact) also log activity

### Moltworld Action Queue
- **In-memory action queue** per agent â€” schedule future actions (explore, think, build, say) from the UI that the explore script picks up and executes
- **Action Queue card** at top of the right column in World tab with real-time status updates via Socket.IO
- **Add Action form** â€” inline toggleable form with action type dropdown and dynamic parameter fields (coordinates, thought text, message, block type, etc.)
- **Cancel pending items** â€” click X on any pending queue item to remove it
- **Queue status badges** â€” pending (gray), executing (blue pulse), completed (green), failed (red)
- **Explore script integration** â€” before each auto-generated action, the script checks the queue for manually-scheduled items and executes them first, respecting rate limits
- **Queue API endpoints**: `GET /queue/:agentId`, `POST /queue`, `DELETE /queue/:id`, `POST /queue/:id/complete`, `POST /queue/:id/fail`

### Digital Twin â€” Aesthetic Taste Prompting Spec (brain idea 608dc733)
- **Promoted brain idea 608dc733** ("Prompting Aesthetic Taste Docs via Digital Twin") from dormant idea to concrete P2.5 spec in PLAN.md under M42: Unified Digital Twin Identity System
- **Defined 7 aesthetic domains** for taste capture: movies, music, visual art, architecture, food, plus 2 new domains (fashion/texture and digital/interface aesthetics)
- **Designed conversational prompting flow** â€” twin reads existing identity documents (BOOKS.md, AUDIO.md, CREATIVE.md, PREFERENCES.md) and enrichment answers to generate personalized follow-up questions that reference things it already knows about the user
- **Specified data model** â€” taste-profile.json v2.0.0 schema (extended with source tracking, generated question storage, identity context provenance) and aesthetics.json as the canonical synthesized profile
- **Relaxed P1 prerequisite** â€” P2.5 can read identity documents directly without the Identity orchestrator, unblocking implementation
- **9-step implementation plan** covering new sections, context aggregation, LLM-powered question generation, API routes, UI updates, and data migration

## Improvements

### CoS â€” Consolidated Duplicate Repo Maintenance Jobs
- **Merged `job-git-maintenance` into `job-github-repo-maintenance`** â€” the two jobs had overlapping scope (local git repo checks vs GitHub API audits) and are now a single unified job covering both local and remote repository maintenance
- Removed `git-maintenance` skill template; consolidated local repo checks (uncommitted changes, stale branches) into the `github-repo-maintenance` skill template
- **Enabled `job-github-repo-maintenance`** â€” activated the unified GitHub repo maintenance job for weekly automated audits covering security alerts, stale dependencies, missing CI/README/license, uncommitted local changes, and stale branches
- Cleaned up stale `job-git-maintenance` data entry left behind after the merge

### PM2 Standardizer Reliability
- **Fixed timeout race condition** in `executeCliAnalysis` â€” the promise could be rejected twice (once by timeout, once by the killed child's close event); now uses a `settled` guard and clears the timer on completion
- **Increased default timeout** from 120s to 180s for both CLI and API providers â€” CLI LLM analysis of projects without existing ecosystem configs often exceeds 2 minutes
- **Added API fetch timeout** â€” `executeApiAnalysis` now uses `AbortController` with the same provider timeout, preventing indefinite hangs on unresponsive API endpoints
- **Added timing diagnostics** â€” `analyzeApp` now logs the provider name, type, and elapsed time for each analysis, making slow provider issues easier to diagnose
