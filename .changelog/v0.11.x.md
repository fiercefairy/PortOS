# Release v0.11.x - Changelog

Released: YYYY-MM-DD

## Overview

This release focuses on security improvements, bug fixes for the AI runner system, and enhanced AI provider model management.

## üéâ Features

### Universal Model Refresh for AI Providers
- **Model Refresh Button**: Added "Refresh Models" button to all AI providers on the `/devtools/providers` page
- **Multi-Provider Support**: Refresh now works for both API and CLI providers including:
  - API providers: OpenAI, LM Studio, Ollama (with provider-specific endpoint detection)
  - CLI providers: Claude/Anthropic (returns latest model list), Gemini (fetches from Google AI API)
- **User Feedback**: Toast notifications show success/failure messages with descriptive error handling
- **Loading States**: Button shows "Refreshing..." state during model fetch operations
- **Graceful Degradation**: Providers without refresh support show appropriate error messages

**Implementation Details**:
- Updated `portos-ai-toolkit` to support provider-specific refresh strategies
- Added `_refreshAPIProviderModels()` for API-based providers with multi-format support
- Added `_refreshCLIProviderModels()` with provider detection and API integration
- Client shows refresh button for all providers (previously API-only)
- Enhanced error handling with user-friendly toast notifications

**Files Modified**:
- `portos-ai-toolkit/src/server/providers.js` - Universal refresh implementation
- `client/src/pages/AIProviders.jsx` - UI updates with toast notifications

## üêõ Bug Fixes

### CLI Runner Security & Reliability
- **Security Warning Fix**: Resolved Node.js DEP0190 deprecation warning in CLI runner by removing unsafe `shell: true` option from child process spawning
- **Improved Argument Handling**: CLI commands now use direct argument passing instead of shell interpretation, preventing potential security vulnerabilities from unescaped arguments
- **Enhanced Logging**: Added detailed logging for CLI execution showing full command and prompt preview to aid debugging
- **Context**: The `/devtools/runner` page was generating security warnings when executing Claude CLI commands. The fix removes shell interpretation which was unnecessary and insecure, while maintaining full functionality

**Technical Details**:
- Created override in `server/services/runner.js` for `executeCliRun()` function
- Removed `shell: true` option from `spawn()` call (recommended by Node.js security guidelines)
- Arguments are now properly passed as array without shell metacharacter interpretation
- Added runtime patching in `server/index.js` to inject fixed implementation into AI toolkit

**Files Modified**:
- `server/services/runner.js` - New secure CLI execution implementation
- `server/index.js` - Runtime patching to override toolkit's runner
